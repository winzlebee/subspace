var F=Object.defineProperty;var w=s=>{throw TypeError(s)};var N=(s,e,t)=>e in s?F(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var M=(s,e,t)=>N(s,typeof e!="symbol"?e+"":e,t),D=(s,e,t)=>e.has(s)||w("Cannot "+t);var i=(s,e,t)=>(D(s,e,"read from private field"),t?t.call(s):e.get(s)),l=(s,e,t)=>e.has(s)?w("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),x=(s,e,t,r)=>(D(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);import{i as A,j as U,k as y,p as j,l as B,m as S,h as z,n as E,o as I,t as O,v as T,x as $,y as C,z as q,A as G,B as H,C as J,D as K}from"./jPXpONmM.js";var c,h,f,d,p,_,m;class Q{constructor(e,t=!0){M(this,"anchor");l(this,c,new Map);l(this,h,new Map);l(this,f,new Map);l(this,d,new Set);l(this,p,!0);l(this,_,()=>{var e=A;if(i(this,c).has(e)){var t=i(this,c).get(e),r=i(this,h).get(t);if(r)U(r),i(this,d).delete(t);else{var a=i(this,f).get(t);a&&(i(this,h).set(t,a.effect),i(this,f).delete(t),a.fragment.lastChild.remove(),this.anchor.before(a.fragment),r=a.effect)}for(const[n,o]of i(this,c)){if(i(this,c).delete(n),n===e)break;const u=i(this,f).get(o);u&&(y(u.effect),i(this,f).delete(o))}for(const[n,o]of i(this,h)){if(n===t||i(this,d).has(n))continue;const u=()=>{if(Array.from(i(this,c).values()).includes(n)){var g=document.createDocumentFragment();I(o,g),g.append(B()),i(this,f).set(n,{effect:o,fragment:g})}else y(o);i(this,d).delete(n),i(this,h).delete(n)};i(this,p)||!r?(i(this,d).add(n),j(o,u,!1)):u()}}});l(this,m,e=>{i(this,c).delete(e);const t=Array.from(i(this,c).values());for(const[r,a]of i(this,f))t.includes(r)||(y(a.effect),i(this,f).delete(r))});this.anchor=e,x(this,p,t)}ensure(e,t){var r=A,a=O();if(t&&!i(this,h).has(e)&&!i(this,f).has(e))if(a){var n=document.createDocumentFragment(),o=B();n.append(o),i(this,f).set(e,{effect:S(()=>t(o)),fragment:n})}else i(this,h).set(e,S(()=>t(this.anchor)));if(i(this,c).set(r,e),a){for(const[u,b]of i(this,h))u===e?r.unskip_effect(b):r.skip_effect(b);for(const[u,b]of i(this,f))u===e?r.unskip_effect(b.effect):r.skip_effect(b.effect);r.oncommit(i(this,_)),r.ondiscard(i(this,m))}else z&&(this.anchor=E),i(this,_).call(this)}}c=new WeakMap,h=new WeakMap,f=new WeakMap,d=new WeakMap,p=new WeakMap,_=new WeakMap,m=new WeakMap;let v=!1,k=Symbol();function R(s,e,t){const r=t[e]??(t[e]={store:null,source:q(void 0),unsubscribe:C});if(r.store!==s&&!(k in t))if(r.unsubscribe(),r.store=s??null,s==null)r.source.v=void 0,r.unsubscribe=C;else{var a=!0;r.unsubscribe=G(s,n=>{a?r.source.v=n:H(r.source,n)}),a=!1}return s&&k in t?J(s):K(r.source)}function V(){const s={};function e(){T(()=>{for(var t in s)s[t].unsubscribe();$(s,k,{enumerable:!1,value:!0})})}return[s,e]}function W(s){var e=v;try{return v=!1,[s(),v]}finally{v=e}}export{Q as B,R as a,W as c,V as s};
